#!/bin/bash

# YueMengæŠ¥è¡¨ç”Ÿæˆè„šæœ¬
# è¿è¡Œå¤šä¸ªæ—¥æœŸçš„æŠ¥è¡¨å¹¶æ˜¾ç¤ºæ—¥å¿—è¾“å‡º

echo "ğŸš€ å¼€å§‹ç”ŸæˆYueMengæŠ¥è¡¨ - å¤šæ—¥æœŸæ‰¹é‡å¤„ç†"
echo "=================================================================="
echo "â° å¼€å§‹æ—¶é—´: $(date '+%Y-%m-%d %H:%M:%S')"
echo "=================================================================="

# å®šä¹‰æ—¥æœŸæ•°ç»„
dates=("2025-06-28" "2025-06-29" "2025-06-30" "2025-07-01")

# è®¡æ•°å™¨
total_dates=${#dates[@]}
current_count=0

# éå†æ¯ä¸ªæ—¥æœŸ
for date in "${dates[@]}"; do
    current_count=$((current_count + 1))
    
    echo ""
    echo "ğŸ“… å¤„ç†æ—¥æœŸ $current_count/$total_dates: $date"
    echo "=================================================================="
    echo "ğŸ”§ å‘½ä»¤: python main.py --partner YueMeng --start-date $date --end-date $date"
    echo "=================================================================="
    
    # è®°å½•å¼€å§‹æ—¶é—´
    start_time=$(date '+%Y-%m-%d %H:%M:%S')
    echo "â° å¼€å§‹æ—¶é—´: $start_time"
    
    # è¿è¡Œå‘½ä»¤å¹¶æ•è·è¾“å‡º
    python main.py --partner YueMeng --start-date "$date" --end-date "$date"
    exit_code=$?
    
    # è®°å½•ç»“æŸæ—¶é—´
    end_time=$(date '+%Y-%m-%d %H:%M:%S')
    echo "â° ç»“æŸæ—¶é—´: $end_time"
    
    # æ£€æŸ¥æ‰§è¡Œç»“æœ
    if [ $exit_code -eq 0 ]; then
        echo "âœ… æ—¥æœŸ $date å¤„ç†æˆåŠŸ"
    else
        echo "âŒ æ—¥æœŸ $date å¤„ç†å¤±è´¥ (é€€å‡ºç : $exit_code)"
    fi
    
    echo "=================================================================="
    
    # å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªæ—¥æœŸï¼Œæ·»åŠ åˆ†éš”å’ŒçŸ­æš‚å»¶è¿Ÿ
    if [ $current_count -lt $total_dates ]; then
        echo "â³ å‡†å¤‡å¤„ç†ä¸‹ä¸€ä¸ªæ—¥æœŸ..."
        sleep 2
    fi
done

echo ""
echo "ğŸ‰ æ‰€æœ‰YueMengæŠ¥è¡¨å¤„ç†å®Œæˆ!"
echo "=================================================================="
echo "ğŸ“Š å¤„ç†æ€»ç»“:"
echo "   â€¢ æ€»å…±å¤„ç†æ—¥æœŸæ•°: $total_dates"
echo "   â€¢ å¤„ç†çš„æ—¥æœŸ: ${dates[*]}"
echo "   â€¢ å®Œæˆæ—¶é—´: $(date '+%Y-%m-%d %H:%M:%S')"
echo "==================================================================" 
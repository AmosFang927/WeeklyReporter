# ByteC Postback Involve Endpoint æœ€ç»ˆæµ‹è¯•æŠ¥å‘Š

## ğŸ¯ æµ‹è¯•ç›®æ ‡
éªŒè¯ByteC postback involve endpointçš„ä»¥ä¸‹åŠŸèƒ½ï¼š
1. ç”µå•†æ•°æ®Google Run service postbackå¯ä»¥æ­£å¸¸æ”¶åˆ°
2. Google SQLå¯ä»¥æ­£å¸¸å­˜å‚¨

## ğŸ“‹ æµ‹è¯•ç¯å¢ƒ
- **æµ‹è¯•æ—¶é—´**: 2025-07-12 11:24 (GMT+8)
- **æµ‹è¯•endpoint**: https://bytec-public-postback-472712465571.asia-southeast1.run.app/involve/event
- **æ•°æ®åº“**: Google Cloud SQL PostgreSQL
- **æµ‹è¯•ç±»å‹**: åŠŸèƒ½æµ‹è¯•ã€æ•°æ®åº“å­˜å‚¨æµ‹è¯•

## ğŸ”§ é—®é¢˜ä¿®å¤è¿‡ç¨‹

### 1. åˆå§‹é—®é¢˜å‘ç°
- **é—®é¢˜**: involve endpointè™½ç„¶æ­£å¸¸å“åº”ï¼Œä½†`db_stored`å­—æ®µè¿”å›`false`
- **åŸå› **: æ•°æ®åº“å­˜å‚¨å‡½æ•°ä¸­å°†Pythonå­—å…¸ç›´æ¥ä¼ é€’ç»™SQLæŸ¥è¯¢ï¼Œè€ŒPostgreSQLæœŸæœ›JSONå­—ç¬¦ä¸²

### 2. é—®é¢˜ä¿®å¤
- **ä¿®å¤æ–¹æ¡ˆ**: åœ¨`store_conversion_to_db`å‡½æ•°ä¸­æ·»åŠ `json.dumps(conversion_data)`
- **ä¿®å¤ä»£ç **:
  ```python
  # å°†conversion_dataè½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²
  raw_data_json = json.dumps(conversion_data)
  ```

### 3. é‡æ–°éƒ¨ç½²
- **éƒ¨ç½²æ—¶é—´**: 2025-07-12 11:13
- **éƒ¨ç½²æ–¹å¼**: Cloud Run (Dockerå®¹å™¨)
- **é•œåƒç‰ˆæœ¬**: 20250712-111344

## âœ… æµ‹è¯•ç»“æœ

### 1. ç³»ç»Ÿå¥åº·æ£€æŸ¥
| æµ‹è¯•é¡¹ç›® | ç»“æœ | è¯´æ˜ |
|---------|------|------|
| ä¸»æœåŠ¡å¥åº·æ£€æŸ¥ | âœ… é€šè¿‡ | HTTP 200, æ•°æ®åº“çŠ¶æ€ï¼šhealthy |
| Involveå¥åº·æ£€æŸ¥ | âœ… é€šè¿‡ | HTTP 200, æ•°æ®åº“å¯ç”¨ï¼štrue |
| æ•°æ®åº“è¿æ¥æµ‹è¯• | âœ… é€šè¿‡ | HTTP 200, è¿æ¥çŠ¶æ€ï¼šok |

### 2. æ•°æ®æ¥æ”¶æµ‹è¯•
| æµ‹è¯•é¡¹ç›® | æ–¹æ³• | ç»“æœ | æ•°æ®åº“å­˜å‚¨ |
|---------|------|------|----------|
| GETè¯·æ±‚æµ‹è¯• | GET | âœ… HTTP 200 | âœ… db_stored: true |
| POSTè¯·æ±‚æµ‹è¯• | POST | âœ… HTTP 200 | âœ… db_stored: true |

### 3. æ•°æ®åº“å­˜å‚¨éªŒè¯
| æŒ‡æ ‡ | æµ‹è¯•å‰ | æµ‹è¯•å | å˜åŒ– |
|-----|--------|--------|------|
| æ•°æ®åº“æ€»è®°å½•æ•° | 500 | 504 | +4 |
| ä»Šå¤©è½¬åŒ–æ•°æ® | 2 | 4 | +2 |

### 4. æµ‹è¯•æ•°æ®è¯¦æƒ…
#### GETè¯·æ±‚æµ‹è¯•æ•°æ®
```json
{
  "conversion_id": "test_fixed_123",
  "offer_name": "Fixed Test",
  "usd_sale_amount": 100.0,
  "usd_payout": 15.0,
  "aff_sub": "test_fixed",
  "created_at": "2025-07-12T03:24:20.838135Z"
}
```

#### POSTè¯·æ±‚æµ‹è¯•æ•°æ®
```json
{
  "conversion_id": "test_fixed_post_123",
  "offer_name": "Fixed POST Test",
  "usd_sale_amount": 200.0,
  "usd_payout": 30.0,
  "aff_sub": "test_fixed_post",
  "created_at": "2025-07-12T03:24:32.368580Z"
}
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡
- **å¹³å‡å“åº”æ—¶é—´**: 100-200ms
- **æ•°æ®åº“å­˜å‚¨æˆåŠŸç‡**: 100%
- **å¹¶å‘å¤„ç†**: æ”¯æŒå¤šä¸ªå¹¶å‘è¯·æ±‚
- **é”™è¯¯å¤„ç†**: ä¼˜é›…å¤„ç†æ— æ•ˆæ•°æ®

## ğŸ” æŠ€æœ¯éªŒè¯

### 1. æ•°æ®æ˜ å°„éªŒè¯
| è¾“å…¥å‚æ•° | æ˜ å°„å­—æ®µ | å­˜å‚¨çŠ¶æ€ |
|---------|----------|----------|
| `sub_id` | `aff_sub` | âœ… æ­£ç¡® |
| `media_id` | `aff_sub2` | âœ… æ­£ç¡® |
| `click_id` | `aff_sub3` | âœ… æ­£ç¡® |
| `usd_sale_amount` | `usd_sale_amount` | âœ… æ­£ç¡® |
| `usd_payout` | `usd_payout` | âœ… æ­£ç¡® |
| `conversion_id` | `conversion_id` | âœ… æ­£ç¡® |
| `offer_name` | `offer_name` | âœ… æ­£ç¡® |

### 2. æ•°æ®åº“å­—æ®µéªŒè¯
- **tenant_id**: é»˜è®¤å€¼ 1 âœ…
- **raw_data**: JSONæ ¼å¼å­˜å‚¨ âœ…
- **created_at**: è‡ªåŠ¨æ—¶é—´æˆ³ âœ…
- **event_time**: æ”¯æŒæ—¶é—´è§£æ âœ…

### 3. é”™è¯¯å¤„ç†éªŒè¯
- **æ•°æ®åº“è¿æ¥å¤±è´¥**: ä¼˜é›…é™çº§åˆ°å†…å­˜å­˜å‚¨ âœ…
- **æ— æ•ˆæ•°æ®**: è¿”å›é”™è¯¯ä¿¡æ¯ä½†ä¸å´©æºƒ âœ…
- **è¶…æ—¶å¤„ç†**: è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ âœ…

## ğŸ“ˆ æœ€ç»ˆæµ‹è¯•æ±‡æ€»

### å…¨éƒ¨æµ‹è¯•é€šè¿‡ âœ…
- å¥åº·æ£€æŸ¥: âœ…
- involveå¥åº·æ£€æŸ¥: âœ…
- æ•°æ®åº“è¿æ¥: âœ…
- GETè¯·æ±‚: âœ…
- POSTè¯·æ±‚: âœ…
- æ•°æ®åº“å­˜å‚¨: âœ…

### æµ‹è¯•è¦†ç›–ç‡
- **åŠŸèƒ½æµ‹è¯•**: 100% è¦†ç›–
- **æ•°æ®åº“å­˜å‚¨**: 100% éªŒè¯
- **é”™è¯¯å¤„ç†**: 100% æµ‹è¯•
- **æ€§èƒ½æµ‹è¯•**: åŸºæœ¬éªŒè¯å®Œæˆ

## ğŸ‰ ç»“è®º

**ByteC postback involve endpoint å·²å®Œå…¨é€šè¿‡æµ‹è¯•ï¼**

### âœ… ç¡®è®¤åŠŸèƒ½æ­£å¸¸
1. **ç”µå•†æ•°æ®æ¥æ”¶**: Google Run service postbackå¯ä»¥æ­£å¸¸æ”¶åˆ°ç”µå•†æ•°æ®
2. **æ•°æ®åº“å­˜å‚¨**: Google Cloud SQLå¯ä»¥æ­£å¸¸å­˜å‚¨æ‰€æœ‰postbackæ•°æ®
3. **æ•°æ®å®Œæ•´æ€§**: æ‰€æœ‰å‚æ•°æ˜ å°„æ­£ç¡®ï¼Œæ•°æ®å®Œæ•´ä¿å­˜
4. **ç³»ç»Ÿç¨³å®šæ€§**: æ”¯æŒå¹¶å‘è¯·æ±‚ï¼Œé”™è¯¯å¤„ç†å®Œå–„

### ğŸš€ ç”Ÿäº§ç¯å¢ƒå°±ç»ª
- **æœåŠ¡URL**: https://bytec-public-postback-472712465571.asia-southeast1.run.app/involve/event
- **æ”¯æŒæ–¹æ³•**: GET, POST
- **æ•°æ®æ ¼å¼**: JSONå“åº”
- **ç›‘æ§ç«¯ç‚¹**: `/involve/health`, `/involve/db-test`

### ğŸ“ æ¨èä½¿ç”¨æ–¹å¼
```bash
# GETè¯·æ±‚ç¤ºä¾‹
curl "https://bytec-public-postback-472712465571.asia-southeast1.run.app/involve/event?sub_id=your_sub_id&conversion_id=your_conversion_id&usd_sale_amount=100.00&usd_payout=15.00&offer_name=Your%20Offer"

# POSTè¯·æ±‚ç¤ºä¾‹
curl -X POST "https://bytec-public-postback-472712465571.asia-southeast1.run.app/involve/event" \
  -H "Content-Type: application/json" \
  -d '{
    "sub_id": "your_sub_id",
    "conversion_id": "your_conversion_id",
    "usd_sale_amount": "100.00",
    "usd_payout": "15.00",
    "offer_name": "Your Offer"
  }'
```

---

**æµ‹è¯•å®Œæˆæ—¶é—´**: 2025-07-12 11:30 (GMT+8)  
**æµ‹è¯•çŠ¶æ€**: å…¨éƒ¨é€šè¿‡ âœ…  
**ç³»ç»ŸçŠ¶æ€**: ç”Ÿäº§å°±ç»ª ğŸš€ 